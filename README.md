# Upgrading Custom Datasets Resolution

This repository implements Super-Resolution Generative Adversarial Networks (SRGAN and ESRGAN) using PyTorch. The models aim to upscale low-resolution images, enhancing their quality for various applications. Currently, SRGAN is fully implemented, while ESRGAN is still in progress.


## Project Overview

### What is SRGAN?

Super-Resolution Generative Adversarial Network (SRGAN) is a deep learning model that enhances image resolution using a Generator-Discriminator setup:
- The Generator transforms a low-resolution image into a high-resolution version.
- The Discriminator differentiates between real high-resolution images and generated ones, helping improve the generator’s performance.
- The Perceptual loss, which includes content loss (VGG-based) and adversarial loss, ensures that upscaled images retain realistic textures and details.

### What is ESRGAN?

Enhanced Super-Resolution Generative Adversarial Network (ESRGAN) is an improvement over SRGAN, with key upgrades:

- Residual-in-Residual Dense Blocks (RRDB): Replace batch normalization layers, improving sharpness and realism.
- Relativistic Discriminator: Instead of a traditional discriminator, it estimates whether real images are more realistic than generated ones, improving stability.
- Perceptual Loss Enhancements: Uses improved feature maps for better texture recovery.

### SRGAN vs ESRGAN

**Feature**         |   **SRGAN**                           |   **ESRGAN**
-------------------------------------------------------------------------------------------------------
Architecture        |   Basic GAN with residual blocks      |   RRDB-based for better texture retention
Discriminator       |   Standard binary classifier          |   Relativistic GAN for improved training
Loss Functions      |   Content + Adversarial loss          |   Improved perceptual loss
Output Quality      |   Decent image enhancement            |   Sharper, more detailed outputs


## Project Structure

```
Upgrading-Custom-Datasets-Resolution/
│── assets/              # Folder to store training loss graphs and GIFs of generated fake images.
│── dataset/             # Folder to store your dataset. You may change the folder name, you will also need to change DATASET_DIR at config.py
│── generated_images/    # Folder to store generated fake images.
│── logs/                # Folder to store TensorBoard logs and training progress.
│── models/              # Folder to store model checkpoints.
│── SRGAN/
│   ├── config.py        # Configuration file with settings and hyperparameters.
│   ├── dataset.py       # Dataset definitions.
│   ├── loss.py          # VGG-based loss functions.
│   ├── model.py         # Generator and Discriminator definitions.
│   ├── train.py         # Training loop setup.
│   ├── utils.py         # Utility functions for saving/loading models, logging, etc.
│── ESRGAN/              # (Upcoming) ESRGAN implementation will be added here.
```


## Dataset Structure

```
dataset/
│── train/
│   ├── lr/  # Low-resolution images
│   ├── hr/  # Corresponding high-resolution images
│
│── val/
│   ├── lr/  # Low-resolution validation images
│   ├── hr/  # Corresponding high-resolution validation images
│
│── test/
│   ├── lr/  # Low-resolution test images (no HR needed for inference)
```


## Image Preparation

- The HR images should be high-resolution (e.g., 256x256, 512x512, etc.).
- The LR images should be generated by downscaling HR images using bicubic interpolation (e.g., to 64x64 or 128x128 if HR is 256x256).


## Installation:

Clone this repository to your local machine:
```
git clone https://github.com/cxycode32/Upgrading-Custom-Datasets-Resolution.git
cd Upgrading-Custom-Datasets-Resolution
```

Install the required dependencies:
```
pip install -r requirements.txt
```


## How to Run?

### Setup

1. Prepare your dataset then place it in the project root directory in a folder named `dataset`.
2. (Optional) You may change the folder name, you will also need to change the `DATASET_DIR` at `config.py`.
3. The configuration parameters (e.g., batch size, learning rate, image resolution) are set in `config.py`.

### Let's Start the Training

1. You may change the `SAVE_MODEL` and `LOAD_MODEL` at `config.py` to `True` or `False` depending on your needs.
2. When `SAVE_MODEL` is set to `True`, your model will be saved inside the `models/` folder every 10 epochs.
3. When `LOAD_MODEL` is set to `True`, you may choose to load the model from which epoch.
4. Run the following command:
```
cd SRGAN
python train.py
```

### Visualization:

### Training Loss Visualization
Helper function to visualize critic and generator losses. The image will be saved inside the `assets` folder.
```
def plot_training_losses(epoch, critic_losses, generator_losses, save_dir=config.ASSETS_DIR, filename="gan_loss"):
```

### Generated Images
Helper function to generate and save images from the generator model. The generated images will be saved inside the `generated_images` folder.
```
def save_generated_images(epoch_folder, generator, alpha, step, epoch, save_dir=config.IMAGE_DIR, fixed_noise=config.FIXED_NOISE):
```

### Generated Images GIF
Helper function to create a GIF from the generated images. The GIF will be saved inside the `assets` folder.
```
def create_gif(epoch_folder, save_dir=config.ASSETS_DIR, image_dir=config.IMAGE_DIR, filename="gan_training"):
```

### Tensorboard
Helper function to log loss values and generated images to TensorBoard. All these are stored inside the `logs` folder.
```
def log_metrics_to_tensorboard(writer, critic_loss, generator_loss, real_images, fake_images, step):
```

Run the following command:
```
tensorboard --logdir logs
```
After you've finished running the script. If you've changed your `LOG_DIR` at `config.py`, remember to replace `logs` in the command to whatever you've changed to.